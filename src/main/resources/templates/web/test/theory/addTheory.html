<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Add Theory</title>
    <style>
        #progressWrapper {
            display: none;
            margin-top: 10px;
        }
        #progressBar {
            width: 0;
            height: 20px;
            background-color: green;
            color: white;
            text-align: center;
            line-height: 20px;
        }
    </style>
    <script>
        function uploadTheory(event) {
            event.preventDefault(); // Ngăn chặn form submit mặc định

            var formData = new FormData(document.getElementById('theoryForm'));
            var progressWrapper = document.getElementById('progressWrapper');
            var progressBar = document.getElementById('progressBar');

            progressWrapper.style.display = 'block'; // Hiển thị chỉ báo tải lên

            fetch('/add/theory', {
                method: 'POST',
                body: formData
            })
                .then(response => response.json())
                .then(data => {
                    if (data.status === 'success') {
                        alert('Theory added successfully!');
                        document.getElementById('theoryForm').reset();
                    } else {
                        alert('Error: ' + data.message);
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('An unexpected error occurred.');
                })
                .finally(() => {
                    progressWrapper.style.display = 'none'; // Ẩn chỉ báo tải lên khi hoàn tất
                });

            // Loại bỏ đoạn mã XMLHTTPRequest
        }
    </script>
</head>
<body>
<h1>Add New Theory</h1>
<form id="theoryForm" onsubmit="uploadTheory(event)" enctype="multipart/form-data">
    <div>
        <label for="name">Name:</label>
        <input type="text" id="name" name="name" placeholder="Enter theory name" required />
    </div>
    <div>
        <label for="orderNumber">Order Number:</label>
        <input type="number" id="orderNumber" name="orderNumber" placeholder="Enter order number" required />
    </div>
    <div>
        <label for="theory">Theory File:</label>
        <input type="file" id="theory" name="theory" required />
    </div>
    <div>
        <label for="video">Video File:</label>
        <input type="file" id="video" name="video" />
    </div>
    <div>
        <label for="lesson">LessonId:</label>
        <input type="number" id="lesson" name="lessonId" />
    </div>
    <div>
        <button type="submit">Add Theory</button>
    </div>
    <div id="progressWrapper">
        <div id="progressBar">0%</div>
    </div>
</form>
</body>
</html>
